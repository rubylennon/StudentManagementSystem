<!--course module show page template-->
<h1 class="p-3 m-3"><%= @course_module.title %> (<%= @course_module.code %>)</h1>

<!--print course module details-->
<table class="table table-hover table-striped">
  <!--render table headers-->
  <%= render :partial => 'course_modules/table_headers' %>
  <tbody>
  <!--render table rows and data-->
  <%= render @course_module %>
  </tbody>
</table>

<!--OWASP A01:2021 – Broken Access Control - https://owasp.org/Top10/A01_2021-Broken_Access_Control/
SECURE - edit delete and add buttons should only be visible to admins-->
<% if current_user && current_user.admin? %>
  <div>
    <%= link_to "Edit Course Module", edit_course_module_path(@course_module), :class => "m-2 btn btn-primary btn-sm"%>
    <%= button_to "Delete Course Module", @course_module, method: :delete, :class => "m-2 btn btn-danger btn-sm" %>
    <%= link_to "New Course Module", new_course_module_path, :class => "m-2 btn btn-success btn-sm" %>
  </div>
<% end %>

<!--back to course modules page link-->
<div>
  <%= link_to "Back to Course Module", course_modules_path, :class => "m-2 btn btn-secondary btn-sm"  %>
</div>

<hr />

<!--OWASP A01:2021 – Broken Access Control - https://owasp.org/Top10/A01_2021-Broken_Access_Control/
SECURE - only logged in users can view course module comments -->
<% if current_user %>
  <!--comments section-->
  <div class="row d-flex justify-content-center">
    <h3 class="p-3 m-3">Comments Section</h3>
    <!--print course_module comments using comments partial-->
    <%= render @course_module.comments %>
    <!--display new comments form using comments form partial-->
    <%= render partial: 'comments/form', locals: { course_module: @course_module }  %>
  </div>
<% end %>
